setwd("C:\\MY DRIVE\\Studies\\project extra\\1\\R code\\Predicition models")
getwd()
library(car)
library(data.table)
library(datasets)

q=read.csv("test_data_for_leaderboard.csv")
print(q)
q1=q[complete.cases(q),]
print(q1)
q1[1,c(16,20,21,22,23,24)]

i=1
c=0

for(i in 1:nrow(q1))
{
if(q1[i,1]==201)
{
s201=read.csv("201.csv")
s1=s201[[2]]
c[i]=s1[1]+(s1[2]*q1[i,20])+(s1[3]*q1[i,24])+(s1[4]*q1[i,23])
} else {

if(q1[i,1]==202)
{
s202=read.csv("202.csv")
s2=s202[[2]]
c[i]=s2[1]+(s2[2]*q1[i,20])+(s2[3]*q1[i,22])+(s2[4]*q1[i,21])+(s2[5]*q1[i,16])
} else {

if(q1[i,1]==203)
{
s203=read.csv("203.csv")
s3=s203[[2]]
c[i]=s3[1]+(s3[2]*q1[i,20])+(s3[3]*q1[i,22])+(s3[4]*q1[i,21])+(s3[5]*q1[i,16])
} else {

if(q1[i,1]==204)
{
s204=read.csv("204.csv")
s4=s204[[2]]
c[i]=s4[1]+(s4[2]*q1[i,20])+(s4[3]*q1[i,22])+(s4[4]*q1[i,21])+(s4[5]*q1[i,16])
} else {

if(q1[i,1]==205)
{
s205=read.csv("205.csv")
s5=s205[[2]]
c[i]=s5[1]+(s5[2]*q1[i,20])+(s5[3]*q1[i,24])+(s5[4]*q1[i,23])+(s5[5]*q1[i,22])+(s5[6]*q1[i,21])+(s5[7]*q1[i,16])
} else {

if(q1[i,1]==206)
{
s206=read.csv("206.csv")
s6=s206[[2]]
c[i]=s6[1]+(s6[2]*q1[i,20])+(s6[3]*q1[i,24])+(s6[4]*q1[i,23])+(s6[5]*q1[i,22])+(s6[6]*q1[i,21])+(s6[7]*q1[i,16])
} else {

if(q1[i,1]==207)
{
s207=read.csv("207.csv")
s7=s207[[2]]
c[i]=s7[1]+(s7[2]*q1[i,20])+(s7[3]*q1[i,24])+(s7[4]*q1[i,23])+(s7[5]*q1[i,22])+(s7[6]*q1[i,21])+(s7[7]*q1[i,16])
} else {

if(q1[i,1]==208)
{
s208=read.csv("208.csv")
s8=s208[[2]]
c[i]=s8[1]+(s8[2]*q1[i,20])+(s8[3]*q1[i,22])+(s8[4]*q1[i,21])+(s8[5]*q1[i,16])
} else {

if(q1[i,1]==209)
{
s209=read.csv("209.csv")
s9=s209[[2]]
c[i]=s9[1]+(s9[2]*q1[i,20])
} else {

if(q1[i,1]==210)
{
s210=read.csv("210.csv")
s10=s210[[2]]
c[i]=s10[1]+(s10[2]*q1[i,20])+(s10[3]*q1[i,24])+(s10[4]*q1[i,23])+(s10[5]*q1[i,16])
} else {

if(q1[i,1]==211)
{
s211=read.csv("211.csv")
s11=s211[[2]]
c[i]=s11[1]+(s11[2]*q1[i,20])+(s11[3]*q1[i,24])+(s11[4]*q1[i,23])
} else {

if(q1[i,1]==212)
{
s212=read.csv("212.csv")
s12=s212[[2]]
c[i]=s12[1]+(s12[2]*q1[i,20])+(s12[3]*q1[i,22])+(s12[4]*q1[i,21])+(s12[5]*q1[i,16])
} else {

if(q1[i,1]==213)
{
s213=read.csv("213.csv")
s13=s213[[2]]
c[i]=s13[1]+(s13[2]*q1[i,20])+(s13[3]*q1[i,24])+(s13[4]*q1[i,23])+(s13[5]*q1[i,22])+(s13[6]*q1[i,21])+(s13[7]*q1[i,16])
} else {

if(q1[i,1]==214)
{
s214=read.csv("214.csv")
s14=s214[[2]]
c[i]=s14[1]+(s14[2]*q1[i,20])+(s14[3]*q1[i,24])+(s14[4]*q1[i,23])+(s14[5]*q1[i,16])
} else {

if(q1[i,1]==215)
{
s215=read.csv("215.csv")
s15=s215[[2]]
c[i]=s15[1]+(s15[2]*q1[i,20])+(s15[3]*q1[i,22])+(s15[4]*q1[i,21])+(s15[5]*q1[i,16])
} else {

if(q1[i,1]==216)
{
s216=read.csv("216.csv")
s16=s216[[2]]
c[i]=s16[1]+(s16[2]*q1[i,20])+(s16[3]*q1[i,24])+(s16[4]*q1[i,23])+(s16[5]*q1[i,16])
} else {

if(q1[i,1]==217)
{
s217=read.csv("217.csv")
s17=s217[[2]]
c[i]=s17[1]+(s17[2]*q1[i,20])+(s17[3]*q1[i,24])+(s17[4]*q1[i,23])+(s17[5]*q1[i,22])+(s17[6]*q1[i,21])
} else {

if(q1[i,1]==218)
{
s218=read.csv("218.csv")
s18=s218[[2]]
c[i]=s18[1]+(s18[2]*q1[i,20])+(s18[3]*q1[i,24])+(s18[4]*q1[i,23])
} else {

if(q1[i,1]==219)
{
s219=read.csv("219.csv")
s19=s219[[2]]
c[i]=s19[1]+(s19[2]*q1[i,20])+(s19[3]*q1[i,22])+(s19[4]*q1[i,21])+(s19[5]*q1[i,16])
} else {

if(q1[i,1]==220)
{
s220=read.csv("220.csv")
s20=s220[[2]]
c[i]=s20[1]+(s20[2]*q1[i,20])+(s20[3]*q1[i,24])+(s20[4]*q1[i,23])+(s20[5]*q1[i,16])
} else {

if(q1[i,1]==221)
{
s221=read.csv("221.csv")
s21=s221[[2]]
c[i]=s21[1]+(s21[2]*q1[i,20])+(s21[3]*q1[i,22])+(s21[4]*q1[i,21])
} else {

if(q1[i,1]==222)
{
s222=read.csv("222.csv")
s22=s222[[2]]
c[i]=s22[1]+(s22[2]*q1[i,20])+(s22[3]*q1[i,24])+(s22[4]*q1[i,23])+(s22[5]*q1[i,22])+(s22[6]*q1[i,21])
} else {

if(q1[i,1]==223)
{
s223=read.csv("223.csv")
s23=s223[[2]]
c[i]=s23[1]+(s23[2]*q1[i,20])+(s23[3]*q1[i,24])+(s23[4]*q1[i,23])+(s23[5]*q1[i,16])
} else {

if(q1[i,1]==224)
{
s224=read.csv("224.csv")
s24=s224[[2]]
c[i]=s24[1]+(s24[2]*q1[i,20])+(s24[3]*q1[i,22])+(s24[4]*q1[i,21])+(s24[5]*q1[i,16])
} else {

if(q1[i,1]==225)
{
s225=read.csv("225.csv")
s25=s225[[2]]
c[i]=s25[1]+(s25[2]*q1[i,20])+(s25[3]*q1[i,24])+(s25[4]*q1[i,23])+(s25[5]*q1[i,16])

}}}}}   #if loop close (station 201 to 225 in counts of 5)
}}}}}  
}}}}}
}}}}}
}}}}}
}       #for loop close




for(i in 1:nrow(q1))
{

if(q1[i,1]==226)
{
s226=read.csv("226.csv")
s26=s226[[2]]
c[i]=s26[1]+(s26[2]*q1[i,20])+(s26[3]*q1[i,24])+(s26[4]*q1[i,23])+(s26[5]*q1[i,22])+(s26[6]*q1[i,21])

} else {
if(q1[i,1]==227)
{
s227=read.csv("227.csv")
s27=s227[[2]]
c[i]=s27[1]+(s27[2]*q1[i,20])+(s27[3]*q1[i,24])+(s27[4]*q1[i,23])

} else {
if(q1[i,1]==228)
{
s228=read.csv("228.csv")
s28=s228[[2]]
c[i]=s28[1]+(s28[2]*q1[i,20])+(s28[3]*q1[i,24])+(s28[4]*q1[i,23])

} else {
if(q1[i,1]==229)
{
s229=read.csv("229.csv")
s29=s229[[2]]
c[i]=s29[1]+(s29[2]*q1[i,20])+(s29[3]*q1[i,22])+(s29[4]*q1[i,21])

} else {
if(q1[i,1]==230)
{
s230=read.csv("230.csv")
s30=s230[[2]]
c[i]=s30[1]+(s30[2]*q1[i,20])+(s30[3]*q1[i,22])+(s30[4]*q1[i,21])

} else {
if(q1[i,1]==231)
{
s231=read.csv("231.csv")
s31=s231[[2]]
c[i]=s31[1]+(s31[2]*q1[i,20])+(s31[3]*q1[i,22])+(s31[4]*q1[i,21])+(s31[5]*q1[i,16])

} else {
if(q1[i,1]==232)
{
s232=read.csv("232.csv")
s32=s232[[2]]
c[i]=s32[1]+(s32[2]*q1[i,20])+(s32[3]*q1[i,24])+(s32[4]*q1[i,23])

} else {
if(q1[i,1]==233)
{
s233=read.csv("233.csv")
s33=s233[[2]]
c[i]=s33[1]+(s33[2]*q1[i,20])+(s33[3]*q1[i,22])+(s33[4]*q1[i,21])+(s33[5]*q1[i,16])

} else {
if(q1[i,1]==234)
{
s234=read.csv("234.csv")
s34=s234[[2]]
c[i]=s34[1]+(s34[2]*q1[i,20])+(s34[3]*q1[i,24])+(s34[4]*q1[i,23])+(s34[5]*q1[i,22])+(s34[6]*q1[i,21])

} else {
if(q1[i,1]==235)
{
s235=read.csv("235.csv")
s35=s235[[2]]
c[i]=s35[1]+(s35[2]*q1[i,20])+(s35[3]*q1[i,24])+(s35[4]*q1[i,23])+(s35[5]*q1[i,22])+(s35[6]*q1[i,21])+(s35[7]*q1[i,16])

} else {
if(q1[i,1]==236)
{
s236=read.csv("236.csv")
s36=s236[[2]]
c[i]=s36[1]+(s36[2]*q1[i,20])+(s36[3]*q1[i,22])+(s36[4]*q1[i,21])+(s36[5]*q1[i,16])

} else {
if(q1[i,1]==237)
{
s237=read.csv("237.csv")
s37=s237[[2]]
c[i]=s37[1]+(s37[2]*q1[i,20])+(s37[3]*q1[i,24])+(s37[4]*q1[i,23])+(s37[5]*q1[i,22])+(s37[6]*q1[i,21])+(s37[7]*q1[i,16])

} else {
if(q1[i,1]==238)
{
s238=read.csv("238.csv")
s38=s238[[2]]
c[i]=s38[1]+(s38[2]*q1[i,20])+(s38[3]*q1[i,24])+(s38[4]*q1[i,23])+(s38[5]*q1[i,16])

} else {
if(q1[i,1]==239)
{
s239=read.csv("239.csv")
s39=s239[[2]]
c[i]=s39[1]+(s39[2]*q1[i,20])+(s39[3]*q1[i,24])+(s39[4]*q1[i,23])+(s39[5]*q1[i,16])

} else {
if(q1[i,1]==240)
{
s240=read.csv("240.csv")
s40=s240[[2]]
c[i]=s40[1]+(s40[2]*q1[i,20])+(s40[3]*q1[i,24])+(s40[4]*q1[i,23])+(s40[5]*q1[i,22])+(s40[6]*q1[i,21])+(s40[7]*q1[i,16])

} else {
if(q1[i,1]==241)
{
s241=read.csv("241.csv")
s41=s241[[2]]
c[i]=s41[1]+(s41[2]*q1[i,20])+(s41[3]*q1[i,24])+(s41[4]*q1[i,23])+(s41[5]*q1[i,16])

} else {
if(q1[i,1]==242)
{
s242=read.csv("242.csv")
s42=s242[[2]]
c[i]=s42[1]+(s42[2]*q1[i,20])+(s42[3]*q1[i,24])+(s42[4]*q1[i,23])

} else {
if(q1[i,1]==243)
{
s243=read.csv("243.csv")
s43=s243[[2]]
c[i]=s43[1]+(s43[2]*q1[i,20])+(s43[3]*q1[i,22])+(s43[4]*q1[i,21])+(s43[5]*q1[i,16])

} else {
if(q1[i,1]==244)
{
s244=read.csv("244.csv")
s44=s244[[2]]
c[i]=s44[1]+(s44[2]*q1[i,20])+(s44[3]*q1[i,24])+(s44[4]*q1[i,23])+(s44[5]*q1[i,16])

} else {
if(q1[i,1]==245)
{
s245=read.csv("245.csv")
s45=s245[[2]]
c[i]=s45[1]+(s45[2]*q1[i,20])+(s45[3]*q1[i,24])+(s45[4]*q1[i,23])

} else {
if(q1[i,1]==246)
{
s246=read.csv("246.csv")
s46=s246[[2]]
c[i]=s46[1]+(s46[2]*q1[i,20])+(s46[3]*q1[i,22])+(s46[4]*q1[i,21])+(s46[5]*q1[i,16])

} else {
if(q1[i,1]==247)
{
s247=read.csv("247.csv")
s47=s247[[2]]
c[i]=s47[1]+(s47[2]*q1[i,20])+(s47[3]*q1[i,24])+(s47[4]*q1[i,23])+(s47[5]*q1[i,22])+(s47[6]*q1[i,21])

} else {
if(q1[i,1]==248)
{
s248=read.csv("248.csv")
s48=s248[[2]]
c[i]=s48[1]+(s48[2]*q1[i,20])+(s48[3]*q1[i,24])+(s48[4]*q1[i,23])+(s48[5]*q1[i,22])+(s48[6]*q1[i,21])

} else {
if(q1[i,1]==249)
{
s249=read.csv("249.csv")
s49=s249[[2]]
c[i]=s49[1]+(s49[2]*q1[i,20])+(s49[3]*q1[i,22])+(s49[4]*q1[i,21])

} else {
if(q1[i,1]==250)
{
s250=read.csv("250.csv")
s50=s250[[2]]
c[i]=s50[1]+(s50[2]*q1[i,20])+(s50[3]*q1[i,24])+(s50[4]*q1[i,23])




}}}}}   #if loop close (station 226 to 250 in counts of 5)
}}}}}  
}}}}}
}}}}}
}}}}}
}       #for loop close




for(i in 1:nrow(q1))
{

if(q1[i,1]==251)
{
s251=read.csv("251.csv")
s51=s251[[2]]
c[i]=s51[1]+(s51[2]*q1[i,20])+(s51[3]*q1[i,24])+(s51[4]*q1[i,23])+(s51[5]*q1[i,16])

} else {

if(q1[i,1]==252)
{
s252=read.csv("252.csv")
s52=s252[[2]]
c[i]=s52[1]+(s52[2]*q1[i,20])+(s52[3]*q1[i,24])+(s52[4]*q1[i,23])

} else {

if(q1[i,1]==253)
{
s253=read.csv("253.csv")
s53=s253[[2]]
c[i]=s53[1]+(s53[2]*q1[i,20])+(s53[3]*q1[i,22])+(s53[4]*q1[i,21])+(s53[5]*q1[i,16])

} else {

if(q1[i,1]==254)
{
s254=read.csv("254.csv")
s54=s254[[2]]
c[i]=s54[1]+(s54[2]*q1[i,20])+(s54[3]*q1[i,24])+(s54[4]*q1[i,23])+(s54[5]*q1[i,22])+(s54[6]*q1[i,21])+(s54[7]*q1[i,16])

} else {

if(q1[i,1]==255)
{
s255=read.csv("255.csv")
s55=s255[[2]]
c[i]=s55[1]+(s55[2]*q1[i,20])+(s55[3]*q1[i,24])+(s55[4]*q1[i,23])+(s55[5]*q1[i,22])+(s55[6]*q1[i,21])

} else {

if(q1[i,1]==256)
{
s256=read.csv("256.csv")
s56=s256[[2]]
c[i]=s56[1]+(s56[2]*q1[i,20])+(s56[3]*q1[i,24])+(s56[4]*q1[i,23])

} else {

if(q1[i,1]==257)
{
s257=read.csv("257.csv")
s57=s257[[2]]
c[i]=s57[1]+(s57[2]*q1[i,20])+(s57[3]*q1[i,24])+(s57[4]*q1[i,23])+(s57[5]*q1[i,16])

} else {

if(q1[i,1]==258)
{
s258=read.csv("258.csv")
s58=s258[[2]]
c[i]=s58[1]+(s58[2]*q1[i,20])+(s58[3]*q1[i,24])+(s58[4]*q1[i,23])

} else {

if(q1[i,1]==259)
{
s259=read.csv("259.csv")
s59=s259[[2]]
c[i]=s59[1]+(s59[2]*q1[i,20])+(s59[3]*q1[i,24])+(s59[4]*q1[i,23])+(s59[5]*q1[i,22])+(s59[6]*q1[i,21])

} else {

if(q1[i,1]==260)
{
s260=read.csv("260.csv")
s60=s260[[2]]
c[i]=s60[1]+(s60[2]*q1[i,20])+(s60[3]*q1[i,24])+(s60[4]*q1[i,23])

} else {

if(q1[i,1]==261)
{
s261=read.csv("261.csv")
s61=s261[[2]]
c[i]=s61[1]+(s61[2]*q1[i,20])+(s61[3]*q1[i,22])+(s61[4]*q1[i,21])

} else {

if(q1[i,1]==262)
{
s262=read.csv("262.csv")
s62=s262[[2]]
c[i]=s62[1]+(s62[2]*q1[i,20])+(s62[3]*q1[i,24])+(s62[4]*q1[i,23])

} else {

if(q1[i,1]==263)
{
s263=read.csv("263.csv")
s63=s263[[2]]
c[i]=s63[1]+(s63[2]*q1[i,20])+(s63[3]*q1[i,22])+(s63[4]*q1[i,21])+(s63[5]*q1[i,16])

} else {

if(q1[i,1]==264)
{
s264=read.csv("264.csv")
s64=s264[[2]]
c[i]=s64[1]+(s64[2]*q1[i,20])+(s64[3]*q1[i,24])+(s64[4]*q1[i,23])+(s64[5]*q1[i,22])+(s64[6]*q1[i,21])+(s64[7]*q1[i,16])

} else {

if(q1[i,1]==265)
{
s265=read.csv("265.csv")
s65=s265[[2]]
c[i]=s65[1]+(s65[2]*q1[i,20])+(s65[3]*q1[i,24])+(s65[4]*q1[i,23])

} else {

if(q1[i,1]==266)
{
s266=read.csv("266.csv")
s66=s266[[2]]
c[i]=s66[1]+(s66[2]*q1[i,20])+(s66[3]*q1[i,21])

} else {

if(q1[i,1]==267)
{
s267=read.csv("267.csv")
s67=s267[[2]]
c[i]=s67[1]+(s67[2]*q1[i,20])+(s67[3]*q1[i,24])+(s67[4]*q1[i,23])+(s67[5]*q1[i,22])+(s67[6]*q1[i,21])

} else {

if(q1[i,1]==268)
{
s268=read.csv("268.csv")
s68=s268[[2]]
c[i]=s68[1]+(s68[2]*q1[i,20])+(s68[3]*q1[i,24])+(s68[4]*q1[i,23])

} else {

if(q1[i,1]==269)
{
s269=read.csv("269.csv")
s69=s269[[2]]
c[i]=s69[1]+(s69[2]*q1[i,20])+(s69[3]*q1[i,22])+(s69[4]*q1[i,21])+(s69[5]*q1[i,16])

} else {

if(q1[i,1]==270)
{
s270=read.csv("270.csv")
s70=s270[[2]]
c[i]=s70[1]+(s70[2]*q1[i,20])+(s70[3]*q1[i,24])+(s70[4]*q1[i,23])

} else {

if(q1[i,1]==271)
{
s271=read.csv("271.csv")
s71=s271[[2]]
c[i]=s71[1]+(s71[2]*q1[i,20])+(s71[3]*q1[i,21])

} else {

if(q1[i,1]==272)
{
s272=read.csv("272.csv")
s72=s272[[2]]
c[i]=s72[1]+(s72[2]*q1[i,20])

} else {

if(q1[i,1]==273)
{
s273=read.csv("273.csv")
s73=s273[[2]]
c[i]=s73[1]+(s73[2]*q1[i,20])+(s73[3]*q1[i,22])+(s73[4]*q1[i,21])+(s73[5]*q1[i,16])

} else {

if(q1[i,1]==274)
{
s274=read.csv("274.csv")
s74=s274[[2]]
c[i]=s74[1]+(s74[2]*q1[i,20])+(s74[3]*q1[i,24])+(s74[4]*q1[i,23])

} else {

if(q1[i,1]==275)
{
s275=read.csv("275.csv")
s75=s275[[2]]
c[i]=s75[1]+(s75[2]*q1[i,20])+(s75[3]*q1[i,24])+(s75[4]*q1[i,23])+(s75[5]*q1[i,22])+(s75[6]*q1[i,21])+(s75[7]*q1[i,16])


}}}}}   #if loop close (station 251 to 275 in counts of 5)
}}}}}  
}}}}}
}}}}}
}}}}}
}       #for loop close










#removing negative fit

k=0
for(k in 1:nrow(q1))
{

if(c[k]<0)
{
c[k]=0
} else {

if(c[k]> q1[k,4])
{
c[k]=q1[k,4]
} else {

c[k]=c[k]
}
}
}
print(c)
mean(c)


round = round(c,0) 
print(round)
mean(round)

floor= floor(c)
print(floor)
mean(floor)



station=q1[,1]
timestamp=q1[,5]
bikes=c

p8= data.frame(station,timestamp,bikes)
print(p8)
write.csv(p8, file = "Arun_BS_Prediction81.csv",row.names=FALSE)


Bikes=round

p9= data.frame(station,timestamp,Bikes)
print(p9)
write.csv(p9, file = "Arun_BS_Prediction91.csv",row.names=FALSE)



BIKES=floor

p10= data.frame(station,timestamp,BIKES)
print(p10)
write.csv(p10, file = "Arun_BS_Prediction101.csv",row.names=FALSE)

warnings()
